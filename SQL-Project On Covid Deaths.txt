/*
Covid 19 Data Exploration 
Skills used: Joins, CTE's, Temp Tables, Windows Functions, Aggregate Functions, Creating Views, Converting Data Types
*/

-- How this works
Select *
from [Portfolio Project]..UniversalCovidDeaths
Where continent is not null 
order by 3,4

-- Data to be worked on
select date, location, new_cases, total_cases, total_deaths, population
from [Portfolio Project]..UniversalCovidDeaths
order by 1,2

-- Total cases vs total death
-- looking at chances of death if covid is contacted in a country
-- DOES NOT WORK, REVIEW
select date, location, total_cases, total_deaths
from [Portfolio Project]..UniversalCovidDeaths
WHERE location LIKE '%states&'
order by 1,2

-- DOES NOT WORK, REVIEW
select date, location, total_cases, total_deaths, (total_deaths/total_cases)*100 as PercentageOfDeaths
from [Portfolio Project]..UniversalCovidDeaths
--where continent IS NOT NULL
order by 1,2

-- Total Cases vs Population
-- Shows what percentage of population infected with Covid
select location, total_cases, population, (total_cases/population)*100 PercentageOfDeaths
from UniversalCovidDeaths
where location like '%states%'
order by 1,2

select location, total_cases, population, (total_cases/population)*100 PercentageOfDeaths
from UniversalCovidDeaths
where location like '%states%' 
--and total_cases is not NULL
order by PercentageOfDeaths DESC

--looking at countires with highest Infection rate compared to population
select location, population, MAX(total_cases) AS HighestTestCount, MAX(total_cases/population)*100 AS InfectedDeathPercentage
from [Portfolio Project]..UniversalCovidDeaths
group by location, population
order by InfectedDeathPercentage desc

-- Countries with Highest Death Count per Population
select location, population, MAX(total_cases) AS HighestTestCount, MAX(total_cases/population)*100 AS InfectedDeathPercentage
from [Portfolio Project]..UniversalCovidDeaths
group by location, population
order by HighestTestCount desc


-- looking at counties with the highest death count By Location
select location, MAX(total_deaths) AS TotalDeathCount, population
from UniversalCovidDeaths
group by location, population
order by TotalDeathCount DESC

--OR

select location, MAX(total_deaths) AS TotalDeathCount
from UniversalCovidDeaths
Where continent is not null
group by location
order by TotalDeathCount DESC


-- COMPREHENSIVE BREAKDOWN

-- Showing contintents with the highest death count per population
--NOT CORRECT, SOME DATAS ARE MISSING
select continent, MAX(total_deaths) AS TotalDeathCount
from UniversalCovidDeaths
Where continent is not null
group by continent
order by TotalDeathCount DESC

--MUCH MORE ACCURATE
select continent, MAX(cast(total_deaths as int)) AS TotalDeathCount
from UniversalCovidDeaths
--where location like '%states%'
Where continent is not null
group by continent
order by TotalDeathCount DESC

-- Showing locations with the highest death count per population
select location, MAX(cast(total_deaths as int)) AS TotalDeathCount
from UniversalCovidDeaths
--where location like '%states%'
Where continent is not null
group by location
order by TotalDeathCount DESC

-- GLOBAL NUMBERS
BY CONTINENT
Select SUM(new_cases) as total_cases, SUM(cast(new_deaths as int)) as total_deaths, SUM(cast(new_deaths as int))/SUM(New_Cases)*100 as DeathPercentage
From UniversalCovidDeaths
--Where location like '%states%'
where continent is not null 
--Group By date
order by 1,2

Select SUM(new_cases) as total_cases, SUM(cast(new_deaths as int)) as total_deaths, SUM(cast(new_deaths as int))/SUM(New_Cases)*100 as DeathPercentage
From UniversalCovidDeaths
--Where location like '%states%'
--where continent is not null 
--Group By date
order by 1,2

Select date, SUM(new_cases) as TotalNewCases
From UniversalCovidDeaths
--Where location like '%states%'
where continent is not null 
Group By date
order by 1,2
